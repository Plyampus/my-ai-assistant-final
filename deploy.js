const { execSync } = require('child_process');

// –û—Ç—Ä–∏–º—É—î–º–æ –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—É –∑ –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ –∞–±–æ —Å—Ç–∞–≤–∏–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π
const commitMessage = process.argv[2] || 'Auto-update: improvements and fixes';

console.log('üöÄ –ü–æ—á–∏–Ω–∞—î–º–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –¥–µ–ø–ª–æ–π...');
console.log('-----------------------------------');

try {
  // 1. –î–æ–¥–∞—î–º–æ –≤—Å—ñ —Ñ–∞–π–ª–∏
  console.log('üì¶ 1. –î–æ–¥–∞—î–º–æ –∑–º—ñ–Ω–∏ (git add)...');
  execSync('git add .', { stdio: 'inherit' });

  // 2. –†–æ–±–∏–º–æ –∫–æ–º—ñ—Ç
  console.log(`üìù 2. –§—ñ–∫—Å—É—î–º–æ –∑–º—ñ–Ω–∏ (git commit): "${commitMessage}"...`);
  try {
    execSync(`git commit -m "${commitMessage}"`, { stdio: 'inherit' });
  } catch (e) {
    console.log('   ‚ö†Ô∏è  –ú–æ–∂–ª–∏–≤–æ, –Ω–µ–º–∞—î –Ω–æ–≤–∏—Ö –∑–º—ñ–Ω –¥–ª—è –∫–æ–º—ñ—Ç—É.');
  }

  // 3. –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –Ω–∞ GitHub
  console.log('‚¨ÜÔ∏è  3. –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –Ω–∞ GitHub (git push)...');
  execSync('git push origin main', { stdio: 'inherit' });

  console.log('-----------------------------------');
  console.log('‚úÖ –£—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ!');
  console.log('‚è≥ Vercel (Frontend) —Ç–∞ Render (Backend) –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ—á–Ω—É—Ç—å –æ–Ω–æ–≤–ª–µ–Ω–Ω—è.');
  console.log('   –ó–∞—á–µ–∫–∞–π—Ç–µ 2-3 —Ö–≤–∏–ª–∏–Ω–∏, –ø–æ–∫–∏ –Ω–æ–≤—ñ –≤–µ—Ä—Å—ñ—ó —Å—Ç–∞–Ω—É—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ñ –æ–Ω–ª–∞–π–Ω.');
} catch (error) {
  console.error('‚ùå –ü–æ–º–∏–ª–∫–∞:', error.message);
  console.log('üí° –ü–æ—Ä–∞–¥–∞: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –≤–∏ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞–ª–∏ git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π.');
}